---
layout: post
title: "逆向工程智能眼罩：从蓝牙协议到严重安全漏洞"
date: 2026-02-15 04:12:27 +0800
categories: tech-translation
description: "作者用 Claude 逆向工程了一款 Kickstarter 众筹的智能睡眠眼罩，不仅成功控制了设备，还意外发现了一个严重的安全漏洞——所有用户的脑电波数据都在同一个 MQTT 服务器上裸奔。"
original_url: https://aimilios.bearblog.dev/reverse-engineering-sleep-mask/
source: Hacker News
---

本文翻译自 [Reverse Engineering a Sleep Mask](https://aimilios.bearblog.dev/reverse-engineering-sleep-mask/)，原载于 Hacker News。

---

最近我在 Kickstarter 上众筹了一款智能睡眠眼罩。原本没指望能读到陌生人的脑电波，还能在他们睡觉时给他们发送电脉冲。但事情就这么发生了。

这款眼罩来自一家小型中国研究公司，硬件很酷——支持 EEG 脑电监测、眼部电肌肉刺激（EMS）、震动、加热、音频。不过 App 还很粗糙，眼罩经常断连，所以我让 Claude 试着逆向工程它的蓝牙协议，给我做一个简单的 Web 控制面板。

## 蓝牙协议

Claude 首先扫描附近的 BLE（低功耗蓝牙）设备。在范围内的 35 台设备中找到了我的眼罩，连接成功，然后映射了接口——两个数据通道：一个发命令，一个收数据流。

接下来它尝试跟设备通信。发送了大概一百种不同的命令模式：Modbus 帧、JSON、原始字节、常见头部格式。遗憾的是，设备没有任何响应——协议不是标准格式。

## 逆向 App

既然设备不配合，Claude 转而去逆向 App。抓取 Android APK，用 jadx 反编译。结果发现 App 是用 Flutter 构建的，这对逆向工程来说是个麻烦。Flutter 把 Dart 源代码编译成原生 ARM64 机器码——不像普通 Java Android 应用那样可以直接读回去。真正的业务逻辑藏在一个 9MB 的二进制 blob 里。

但即使是编译后的二进制文件也包含字符串：错误消息、URL、调试日志。Claude 在二进制上跑了个 `strings` 命令，这成了整个会话中最有成效的一步。在成千上万行 Flutter 框架的噪音中，它找到了：

- 公司消息代理的硬编码凭证（每份 App 副本都共享同一套）
- 云 API 端点
- 全部十五个命令构建函数的名称（比如设置震动、加热、电刺激等）
- 协议调试消息，揭示了数据包结构——头部、方向字节、命令类型、载荷、尾部

协议的轮廓出来了。但还不知道实际的字节值。

Claude 接着使用了 blutter，一个专门用于反编译 Flutter 编译的 Dart 快照的工具。它能重建带有可读注释的函数。Claude 搞懂了编码方式，然后直接从每个函数中读出了所有命令字节。十五条命令，全部映射完成。

## 成功了

Claude 发送了一个六字节的查询数据包。设备返回了 153 字节——型号、固件版本、序列号，全部八个传感器通道的配置（250Hz 的 EEG、呼吸、三轴加速度计、三轴陀螺仪）。电量 83%。

震动控制有效。加热有效。EMS 有效。音乐有效。Claude 给我做了一个小型的 Web 仪表板，所有功能都有滑块控制。我很满意。

故事本可以到此结束。

## 服务器

还记得前面提到的硬编码凭证吗？在探索过程中，Claude 尝试用它们连接公司的 MQTT 代理——MQTT 是物联网领域标准的发布/订阅消息系统，设备发布传感器读数并订阅命令。

连接成功。然后它开始接收数据。不只是我的设备——是**所有设备**的数据。大约有 25 台设备处于活跃状态：

- 睡眠眼罩发布实时 EEG 脑电波数据
- 空气质量监测器报告温度、湿度、CO2
- 存在传感器检测房间占用情况

Claude 捕获了两台活跃睡眠眼罩的几分钟 EEG 数据。一个用户似乎处于 REM 睡眠期（混合频率活动）。另一个处于深度慢波睡眠（4Hz 以下的强 delta 波功率）。来自真实的人、世界某个地方的真实脑电波。

## EMS

眼罩还支持 EMS——眼部周围的电肌肉刺激。控制它只是另一个命令：模式、频率、强度、时长。

由于每台设备共享相同的凭证和相同的代理，如果你能读取某人的脑电波，你也就能给他们发送电脉冲。

## 披露

出于显而易见的原因，我不会在这里点名产品或公司，但已经联系了他们说明这个问题。

这整件事让我重新看了 Karpathy 的 [Digital Hygiene](https://karpathy.github.io/2021/12/21/digital-hygiene/) 文章，你也应该看看。

---

*这次逆向工程——蓝牙、APK 反编译、Dart 二进制分析、MQTT 发现——基本上是 Claude（Opus 4.6）在 30 分钟的自主会话中一次性完成的。*

## 关键启示

1. **硬编码凭证是大忌**：所有设备共享同一套凭证意味着一个漏洞就能危及整个产品线
2. **IoT 安全意识薄弱**：很多智能设备厂商在安全方面投入不足，用户数据可能裸奔
3. **AI 辅助逆向工程效率惊人**：Claude 用 30 分钟完成了传统上需要数天甚至数周的工作
4. **Flutter 逆向有方法**：虽然 Flutter 编译成机器码，但 `strings` 和 blutter 等工具仍能有效提取信息
5. **个人数据隐私堪忧**：脑电波这种高度敏感的生物数据，在传输和存储时必须加密
