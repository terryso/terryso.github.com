---
layout: post
title: "用 Claude 逆向工程智能睡眠眼罩：从蓝牙协议到发现安全漏洞"
date: 2026-02-15 08:20:12 +0800
categories: tech-translation
description: "作者用 Claude 逆向工程一款 Kickstarter 众筹的智能睡眠眼罩，成功解析蓝牙协议后，意外发现厂商的 MQTT 服务器存在严重安全漏洞——任何人都可以读取所有用户的脑电波数据，甚至发送电刺激脉冲。"
original_url: https://aimilios.bearblog.dev/reverse-engineering-sleep-mask/
source: Hacker News
---

本文翻译自 [Reverse Engineering a Sleep Mask](https://aimilios.bearblog.dev/reverse-engineering-sleep-mask/)，原载于 Hacker News。

---

最近我在 Kickstarter 上众筹了一款智能睡眠眼罩。我完全没预料到，这会让我获得读取陌生人脑电波、甚至在他们睡眠时发送电脉冲的能力。但事情就是这样发生的。

这款眼罩来自一家中国的小型研究公司，硬件相当酷——配备了 EEG 脑电监测、眼部肌肉电刺激（EMS）、振动、加热、音频等功能。不过 App 还很粗糙，眼罩经常断连，于是我让 Claude 尝试逆向工程蓝牙协议，给我做一个简单的 Web 控制面板。

## 蓝牙协议探索

Claude 首先扫描附近的 BLE（低功耗蓝牙）设备。在 35 个设备中找到了我的眼罩，连接后映射出接口——两个数据通道：一个发送命令，一个流式传输数据。

然后它尝试与设备通信。发送了大约一百种不同的命令模式：Modbus 帧、JSON、原始字节、常见头部格式……遗憾的是，设备毫无响应——协议不是标准格式。

## 逆向 App

既然设备不配合，Claude 转而逆向 App。抓取 Android APK，用 jadx 反编译。结果发现 App 是用 Flutter 构建的——这对逆向工程是个麻烦。Flutter 将 Dart 源代码编译成原生 ARM64 机器码，不像普通 Java Android 应用那样可以直接读取。实际的业务逻辑藏在一个 9MB 的二进制 blob 里。

但即使是编译后的二进制文件，里面也有字符串——错误信息、URL、调试日志。Claude 对二进制文件运行 `strings` 命令，这成了整个过程中产出最高的一步。在数千行 Flutter 框架的噪音中，它找到了：

- 公司消息代理的硬编码凭据（每份 App 共用同一套）
- 云 API 端点
- 全部 15 个命令构建函数的名称（如设置振动、加热、电刺激等）
- 协议调试信息，揭示了数据包结构——头部、方向字节、命令类型、载荷、尾部

我们掌握了协议的轮廓，但还不知道实际的字节值。

Claude 接着使用了 blutter——一个专门用于反编译 Flutter 编译后 Dart 快照的工具。它能重建带有可读注释的函数。Claude 破解了编码方式，直接从每个函数中读出了所有命令字节。15 条命令，完全映射。

## 成功了

Claude 发送了一个 6 字节的查询数据包。设备返回了 153 字节——型号、固件版本、序列号、全部 8 个传感器通道配置（250Hz EEG、呼吸监测、三轴加速度计、三轴陀螺仪）。电量 83%。

振动控制正常。加热正常。EMS 正常。音乐正常。Claude 给我做了一个简洁的 Web 控制面板，各种功能都有滑块控制。我很满意。

故事本可以到此结束。

## 服务器的秘密

还记得之前发现的硬编码凭据吗？在探索过程中，Claude 尝试用这些凭据连接公司的 MQTT 代理——MQTT 是物联网领域的标准发布/订阅消息系统，设备发布传感器数据并订阅命令。

连接成功。然后开始接收数据。不只是我的设备——是**所有设备**。大约有 25 台设备在线：

- 睡眠眼罩在发布实时 EEG 脑电波数据
- 空气质量监测器在报告温度、湿度、CO2
- 存在传感器在检测房间占用情况

Claude 捕获了两台活跃睡眠眼罩几分钟的 EEG 数据。一位用户似乎处于 REM 睡眠期（混合频率活动）。另一位处于深度慢波睡眠（4Hz 以下的强 delta 波）。来自世界上某处的真实脑电波。

## EMS 的安全隐患

眼罩还支持 EMS——眼部肌肉电刺激。控制它只是另一个命令：模式、频率、强度、持续时间。

由于每台设备共享相同的凭据和相同的代理，**如果你能读取某人的脑电波，你也就能给他们发送电脉冲**。

## 披露

出于显而易见的原因，我不会在这里点名产品或公司，但已经联系他们告知这个问题。

这整件事让我重新审视了 Karpathy 的 [Digital Hygiene](https://karpathy.github.io/2025/02/04/digital-hygiene/) 文章，你也应该读读。

---

*这次逆向工程——蓝牙、APK 反编译、Dart 二进制分析、MQTT 发现——基本上是 Claude（Opus 4.6）在 30 分钟的自主会话中一次性完成的。*

## 译者总结

这篇文章展示了几个值得注意的点：

1. **AI 辅助逆向工程的威力**：Claude 在 30 分钟内自主完成了从蓝牙协议分析到 APK 逆向的完整流程，这在过去需要专业安全研究员数天的工作。

2. **Flutter 应用的逆向难点**：相比传统 Java Android 应用，Flutter 编译后的 Dart 代码更难逆向，需要专门的工具如 blutter。

3. **IoT 安全的普遍问题**：硬编码凭据、不隔离用户数据、MQTT 无认证——这些都是物联网设备常见的低成本错误。

4. **隐私风险的真实性**：脑电波数据属于敏感的生物识别信息，这类设备的安全漏洞影响远超普通数据泄露。

对于开发者来说，如果你在做 IoT 产品，请务必：
- 每台设备使用唯一凭据
- 在服务端隔离不同用户的数据
- 对敏感操作进行额外的身份验证
